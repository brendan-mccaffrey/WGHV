<!DOCTYPE html>
<html lang="en">

<head>
	<title>TIMS</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-firestore.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
	<script>
		var firebaseConfig = {
			apiKey: "AIzaSyDQCfr1bfMkJc_-on2eCbzh3i2ZplSkjfM",
			authDomain: "wharton-volunteers.firebaseapp.com",
			databaseURL: "https://wharton-volunteers.firebaseio.com",
			projectId: "wharton-volunteers",
			storageBucket: "wharton-volunteers.appspot.com",
			messagingSenderId: "1067661612787",
			appId: "1:1067661612787:web:b6eac7c8fb4aff84260986"
		};
		firebase.initializeApp(firebaseConfig);
	</script>

</head>

<body style="background-color:AliceBlue;">


	<div class="row" style="background-color:Navy;">
		<div class="col">
			<h1 align="center" style="color:white;">Transformational Impact Measurement System</h1>
			<p align="center" style="color:white;"> <i>An Online Platform to Connect Hospitals with Volunteers and
					Donors</i></p>
		</div>
	</div>

	<div style="background-color:WhiteSmoke;">
		<ul class="nav nav-tabs nav-justified">
			<li class="nav-item" style="border:1px solid black;">
				<a class="nav-link" href="index.html">Home</a>
			</li>
			<li class="nav-item" style="border:1px solid black;">
				<a class="nav-link" href="about.html">About Us</a>
			</li>
			<li class="nav-item" style="border:1px solid black;">
				<a class="nav-link" href="auth.html">Add New Hospital</a>
			</li>
		</ul>
	</div>

	<script>
		function getParameterByName(name) {
			var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
			return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
		}


		var db = firebase.firestore();
		var username = getParameterByName("username");
		var docRef = db.collection("hospitals").doc(username);

		docRef.get().then(function (doc) {
			if (doc.exists) {
				console.log("Document data:", doc.data());
				//Hospital info
				document.getElementById("hospitalName").innerHTML = String(doc.get("Hospital Name"))
				document.getElementById("hospitalAddress").innerHTML = String(doc.get("Hospital Address"))
				document.getElementById("hospitalContact").innerHTML = String(doc.get("Hospital Contact"))
				document.getElementById("hospitalRating").innerHTML = String(doc.get("R rating").toFixed(2)) + " / 5"

				//Subcategories
				document.getElementById("scFundingSources").innerHTML = String(doc.get("SC funding sources").toFixed(2))
				document.getElementById("scFinancialEfficiency").innerHTML = String(doc.get("SC financial efficiency").toFixed(2))
				document.getElementById("scFinancialCapacity").innerHTML = String(doc.get("SC financial capacity").toFixed(2))
				document.getElementById("scAccountability").innerHTML = String(doc.get("SC accountability").toFixed(2))
				document.getElementById("scOperationalEfficiency").innerHTML = String(doc.get("SC operational effciency").toFixed(2))
				document.getElementById("scGovernance").innerHTML = String(doc.get("SC governance").toFixed(2))
				document.getElementById("scTransparency").innerHTML = String(doc.get("SC transparency").toFixed(2))
				document.getElementById("scOrganizationQuality").innerHTML = String(doc.get("SC organization quality").toFixed(2))
				document.getElementById("scVolume").innerHTML = String(doc.get("SC volume").toFixed(2))
				document.getElementById("scCareQuality").innerHTML = String(doc.get("SC care quality").toFixed(2))

			} else {
				location.href = "index.html"
				console.log("No such document!");
			}
		}).catch(function (error) {
			console.log("Error getting document:", error);
		});
	</script>

	<div class="container-fluid">

		<div class="row">
			<div class="col">
				<br><br>
				<div class="container">
					<h2 id="hospitalName"> </h2>
					<p id="hospitalRating"></p>
					<hr>
					<div class="row">

						<div class="col-sm">
							<h3> Address </h3>
							<p id="hospitalAddress"></p>
						</div>
						<div class="col-sm">
							<h3> Contact </h3>
							<p id="hospitalContact"></p>
						</div>
					</div>
				</div>
				<br><br>

				<div class="container-fluid">
					<h3 align="center">Category Ratings</h3>

					<canvas id="myChart"></canvas>
					<script>
						function getParameterByName(name) {
							var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
							return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
						}


						var db = firebase.firestore();
						var username = getParameterByName("username");
						var docRef = db.collection("hospitals").doc(username);


						docRef.get().then(function (doc) {
							if (doc.exists) {

								var ctx = document.getElementById('myChart').getContext('2d');

								var chart = new Chart(ctx, {
									// The type of chart we want to create
									type: 'bar',

									// The data for our dataset
									data: {
										labels: ['Regional Impact Potential', 'Financial Health', 'Operational Performance', 'External Relations', 'Volunteer Opportunity', 'Volunteer Satisfaction'],
										datasets: [{
											label: 'Rating on a scale from 0 to 5',
											backgroundColor: 'rgb(51, 105, 255)',
											data: [doc.get("C regional impact potential").toFixed(2),
											doc.get("C financial health").toFixed(2),
											doc.get("C operational performance").toFixed(2),
											doc.get("C external relations").toFixed(2),
											doc.get("C volunteer opportunity").toFixed(2),
											doc.get("C volunteer satisfaction").toFixed(2)]

										}]
									},
									options: {
										scales: {
											yAxes: [{
												ticks: {
													suggestedMax: 5
												}
											}]
										}

									}
								});

							} else {
								location.href = "index.html"
								console.log("No such document!");
							}
						}).catch(function (error) {
							console.log("Error getting document:", error);
						});

					</script>

				</div>

				<br><br>

				<div class="container">
					<h3 align="center"> Subcategory Ratings</h3>
					<br>
					<table class="table table-hover">
						<tr style="background-color: navy; color: whitesmoke">
							<th>Subcategory</th>
							<th>Rating</th>
							<th>Description</th>
						</tr>
						<tr>
							<td>Funding Sources</td>
							<td id="scFundingSources">fs</td>
							<td></td>
						</tr>
						<tr>
							<td>Financial Efficiency</td>
							<td id="scFinancialEfficiency"></td>
							<td></td>
						</tr>
						<tr>
							<td>Financial Capacity</td>
							<td id="scFinancialCapacity"></td>
							<td></td>
						</tr>
						<tr>
							<td>Accountability</td>
							<td id="scAccountability"></td>
							<td></td>
						</tr>
						<tr>
							<td>Operational Efficiency</td>
							<td id="scOperationalEfficiency"></td>
							<td></td>
						</tr>
						<tr>
							<td>Governance</td>
							<td id="scGovernance"></td>
							<td></td>
						</tr>
						<tr>
							<td>Transparency</td>
							<td id="scTransparency"></td>
							<td></td>
						</tr>
						<tr>
							<td>Organization Quality</td>
							<td id="scOrganizationQuality"></td>
							<td></td>
						</tr>
						<tr>
							<td>Volume</td>
							<td id="scVolume"></td>
							<td></td>
						</tr>
						<tr>
							<td>Care Quality</td>
							<td id="scCareQuality"></td>
							<td></td>
						</tr>
					</table>

				</div>

				<br><br>


			</div>
		</div>

	</div>

</body>



</html>